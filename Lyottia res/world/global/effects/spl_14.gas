[effect_script*] // -ET
{
	name	=lyottia_14_crystal_lightning_black;
    script	=[[
        //////////////////////////////////////////////////////////////
        set $color_1 0;
        set $color_2 0;
        set $color_3 1;

        // If I specify #TARGET here, i can make equivalent to call ligtning
        sfx create orbiter #SOURCE
            "must_update()invisible()radius(0)offset(1, 2, .3)";
        set $source_orb #POP;
        sfx start $source_orb;

        // create three lightning bolts, and string the between the target and the source.
        sfx create lightning #TARGET_KB 
            "must_update()bolt_life(1)mindisplace(0)maxdisplace(0)subd(5.0)minsubd(3.0)
            color0($color_1,$color_2,$color_3)[1][0]";
        sfx target #PEEK $source_orb;
        sfx start #POP;

        sfx create lightning #TARGET_KB 
            "must_update()bolt_life(1)mindisplace(0)maxdisplace(0)subd(5.0)minsubd(3.0)
            color0($color_1,$color_2,$color_3)[1]";
        sfx target #PEEK $source_orb;
        sfx start #POP;

        sfx create lightning #TARGET_KB 
            "must_update()bolt_life(1)mindisplace(0)maxdisplace(0)subd(5.0)minsubd(3.0)
            color0($color_1,$color_2,$color_3)[1]";
        sfx target #PEEK $source_orb;
        sfx start #POP;

        sfx start $source_orb;

        sfx create explosion #TARGET 
            "must_update()omni_dir()ivel(0,0,0)rvel(3,0,3)scale_range(0,.5,0)
            texture(b_sfx_sparkle01)color0($color_1,$color_2,$color_3)color1($color_1,$color_2,$color_3)
            dur(2)radius(.4)fade_range(0,1,0)count(25)";
        sfx start #POP;
    ]];
}
[effect_script*]
{
	name	=lyottia_14_energy_ball_1;

	script	=[[
			sound play s_e_spell_nova_strike_cast_SED at #SOURCE_POSITION dist 3 35;

        set $color_1_1 .812;
        set $color_1_2 1;
        set $color_1_3 .627;

        sfx create trackball #TARGET_KB 
            "";
        set $ball #POP;
        sfx position_at $ball @weapon_bone source;
        sfx friendly party $ball;
        sfx start $ball;
        
        sfx create lightsource #TARGET 
            "color0($color_1_1,$color_1_2,$color_1_3)tin(.3)tout(.3)radius(7)";
        sfx rat #PEEK;
        sfx target #PEEK $ball;
        sfx attach $ball #PEEK;

        sfx create sray #POP 
                "must_update()count(8)ts(5)offset(0,.5,0)
                scale(2)radius(.5)lmin(2)lmax(5)color0($color_1_1,$color_1_2,$color_1_3)color1(1,0,1)
                theta(.1,.2,.3)phi(.3,.2,.1)wsmin(.1)wsmax(.2)wemin(.5)wemax(.9)";
        sfx rat #PEEK;
        sfx target #PEEK $ball;
        sfx attach $ball #PEEK;
        
        waitfor collision $ball #DEFAULT_TIMEOUT;
        set $collision_type #POP;

        if ( $collision_type == #TERRAIN_COLLISION )
        {
            get collision point $ball;
            sfx create explosion #POP
                "vmin(6)vmax(12)omni_dir()ts(.5)scale(.4)
                scale_range(.4,.66,0)color0($color_1_1,$color_1_2,$color_1_3)
                color1(1,0,1)radius(.5)fade_range(1,1,0)";
            sfx start #POP;
        }
        else if ( $collision_type == #OBJECT_COLLISION )
        {				
            get collision target $ball target;
            sfx create explosion #TARGET_KB 
                "vmin(6)vmax(12)omni_dir()ts(.5)scale(.4)
                scale_range(.4,.66,0)color0($color_1_1,$color_1_2,$color_1_3)
                color1(1,0,1)radius(.5)fade_range(1,1,0)";
            sfx start #POP;
        }

        worldmsg WE_SPELL_SYNC_END #INVALID_GOID #OWNER_GOID #TARGET_GOID;
    ]];
}
[effect_script*]  // - ET
{
	name	=lyottia_14_blaster;

	script	=[[
        sound play s_e_spell_fireshot_cast at #SOURCE_POSITION dist 3 25;

        ////////////////////////////////////////
        // shoot lots o shots really quickly.

        call blaster_base s<0,0,15>; 

        call blaster_base s<.75,1,15>;
        call blaster_base s<-.75,-1,15>;

        call blaster_base s<.75,-1,15>;
        call blaster_base s<-.75,1,15>;

        call blaster_base s<1.5,0,15>;
        call blaster_base s<-1.5,0,15>;

        call blaster_base s<3,0,15>;
        call blaster_base s<-3,0,15>;

        call blaster_base s<3.75,0,15>;
        call blaster_base s<-3.75,0,15>;

        call blaster_base s<4.25,0,15>;
        call blaster_base s<-4.25,0,15>;

        call blaster_base s<5,0,15>;
        call blaster_base s<-5,0,15>;

        call blaster_base s<5.75,0,15>;
        call blaster_base s<-5.75,0,15>;

        call blaster_base s<6.25,0,15>;
        call blaster_base s<-6.25,0,15>;

        call blaster_base s<7,0,15>;
        call blaster_base s<-7,0,15>;

        pause 4;
        
        worldmsg WE_SPELL_SYNC_END #OWNER_GOID #OWNER_GOID #TARGET_GOID;
        ]];
}